import asyncio
import websockets
import json
from server.utils.data_util import *
from server.cache.datacache import *

with open(f'abc_acce.csv', 'a', newline='') as f:
    writer = csv.writer(f)
    writer.writerow(['at', 'ax', 'ay', 'az'])
with open(f'abc_gyro.csv', 'a', newline='') as f:
    writer = csv.writer(f)
    writer.writerow(['gt', 'gx', 'gy', 'gz'])
with open(f'abc_game_rv.csv', 'a', newline='') as f:
    writer = csv.writer(f)
    writer.writerow(['rt', 'w', 'x', 'y', 'z'])


# logging.basicConfig(filename='/home/a/桌面/git/Fusion-DHL-master/server/log_txt/ws_run_log.txt', level=logging.DEBUG)

def com_data(data):
    data['id'] = 'abc'
    id = data['id']
    cache = dir.get(id, DataCache(id))
    if data['id'] not in dir:
        dir[data['id']] = cache
    if 'JDWD' in data:
        uwb_time = cache.ts_pos[-1][0] if len(cache.ts_pos) > 0 else time.time()
        uwb_pos = [uwb_time, data['JDWD'][1], data['JDWD'][0], 5]
        cache.updata_pos(uwb_pos)
        cache.save_csv()
        return cache.optimized_uwb

    cache.imu_data.load_data_from_dir(data)
    cache.imu_data.load_data_from_file('/home/a/桌面/git/Fusion-DHL-master/server/pos_csv')
    with cache.lock:
        times_preds = []
        while len(cache.imu_data) >= 200:
            feat = cache.imu_data.get_one_feat(200, 10)
            with torch.no_grad():
                pred = network(feat.to(device)).cpu().detach().numpy()
            times_preds.append([time.time()] + pred[0, :].tolist())
        cache.com_preds(times_preds)
        times_preds.clear()
        cache.save_csv()
        return cache.optimized_uwb


async def echo(websocket, path):
    async for message in websocket:
        data = json.loads(message)
        if 'JDWD' in data:
            print('----', message)
        if ('acce' not in data or 'gyro' not in data or 'game_rv' not in data) and 'JDWD' not in data:
            await websocket.send(f"Error: no data")
        else:
            try:
                uwb = com_data(data)
                print("-----------------------------------------------")
                await websocket.send(json.dumps({"uwb": uwb.tolist()}, indent=4))
            except Exception as e:
                print(e)
                continue


async def imu_server():
    async with websockets.serve(echo, "0.0.0.0", 47737):
        await asyncio.Future()  # 运行服务器直到手动停止


def receive_location(data):
    data['id'] = 'abc'
    id = data['id']
    if id not in dir:
        return
    cache = dir.get(id, DataCache(id))
    if 'location' in data:
        uwb_time = data['location_time']
        uwb_pos = [uwb_time, data['location'][1], data['location'][0], data['score']]
        cache.updata_pos(uwb_pos)


async def websocket_client():
    uri = "ws://192.168.10.171:8765"
    async with websockets.connect(uri) as websocket:
        print("Connected to WebSocket server:", uri)
        while True:
            # {"location": [117.05533457197978, 39.05631400892301], "location_time": 1734068339.8625245,"score": 0.8712250754089781, "timestamp": "2024-12-13 13:39:05", "code": 1}
            message = await websocket.recv()
            print("Received message:", message)
            data = json.loads(message)
            if 'location' in data and data['code'] == 1:
                receive_location(data)


async def run_services():
    # await asyncio.gather(imu_server(), websocket_client())
    await asyncio.gather(imu_server())


if __name__ == "__main__":
    dir = {}
    plt.ion()
    plt.figure()
    device = torch.device("cuda:0" if torch.cuda.is_available() else "cpu")
    network = get_model('/home/a/桌面/git/IMUNet/RONIN_torch/Train_out/ResNet/all4data/checkpoint_best64.pt')
    com_data({
        "id": 123,
        "acce": [[583167242240150, 0.21900001, -0.27, 9.87405], [583167252019530, 0.21900001, -0.25800002, 9.88605], [583167261798628, 0.21105, -0.25800002, 9.87405], [583167271577782, 0.21900001, -0.25305, 9.879001], [583167281356873, 0.22095, -0.24795002, 9.87195], [583167291136174, 0.21900001, -0.25095, 9.88395], [583167300915330, 0.20895001, -0.26295, 9.882001], [583167310694632, 0.22800002, -0.25305, 9.901051], [583167320473801, 0.22305001, -0.25995, 9.88395], [583167330252878, 0.22095, -0.27, 9.87405], [583167340032280, 0.21900001, -0.27, 9.88395], [583167349811359, 0.21405001, -0.27195, 9.88395], [583167359590675, 0.23805001, -0.25800002, 9.879001], [583167369369831, 0.23295002, -0.25305, 9.88395], [583167379149141, 0.23295002, -0.25995, 9.88395], [583167388928297, 0.23295002, -0.26295, 9.88395], [583167398707374, 0.21900001, -0.25800002, 9.870001], [583167408486680, 0.22095, -0.27, 9.89295], [583167418265855, 0.21900001, -0.27, 9.882001], [583167428045160, 0.21405001, -0.27, 9.87195], [583167437824223, 0.21900001, -0.24795002, 9.88605], [583167447603366, 0.22800002, -0.27, 9.882001], [583167457382693, 0.21900001, -0.25995, 9.891001], [583167467161868, 0.20895001, -0.26805001, 9.88605], [583167476941173, 0.21405001, -0.26295, 9.87195], [583167486720300, 0.21105, -0.25605002, 9.8890505], [583167496499377, 0.22605, -0.25305, 9.882001], [583167506278741, 0.22305001, -0.26295, 9.86505], [583167516057791, 0.22095, -0.27195, 9.86505], [583167525837097, 0.21405001, -0.26805001, 9.87405], [583167535616267, 0.22305001, -0.27495003, 9.88395], [583167545395339, 0.22605, -0.28005, 9.87705], [583167555174722, 0.22095, -0.26295, 9.89295], [583167564954020, 0.22605, -0.26505002, 9.882001], [583167574733104, 0.22605, -0.24795002, 9.87405], [583167584512263, 0.22605, -0.25305, 9.88605], [583167594291529, 0.22605, -0.25605002, 9.87195], [583167604070685, 0.22095, -0.25605002, 9.88605], [583167613849744, 0.21405001, -0.25995, 9.88395], [583167623629050, 0.21900001, -0.25995, 9.879001], [583167633408224, 0.22305001, -0.27705002, 9.88395], [583167643187501, 0.216, -0.27495003, 9.882001], [583167652966657, 0.21405001, -0.27495003, 9.879001], [583167662745728, 0.22095, -0.26295, 9.867001], [583167672525126, 0.22305001, -0.26295, 9.882001], [583167682304205, 0.22095, -0.25800002, 9.87405], [583167692083501, 0.22305001, -0.25800002, 9.86505], [583167701862656, 0.22095, -0.25095, 9.88605], [583167711641748, 0.22305001, -0.26805001, 9.882001], [583167721421130, 0.216, -0.27, 9.891001], [583167731200438, 0.22095, -0.26295, 9.879001], [583167740979522, 0.216, -0.282, 9.8890505], [583167750758676, 0.21900001, -0.26295, 9.882001], [583167760537981, 0.216, -0.26505002, 9.86505], [583167770317137, 0.21405001, -0.25605002, 9.90495], [583167780096438, 0.22605, -0.27, 9.870001], [583167789875517, 0.216, -0.25605002, 9.86205], [583167799654664, 0.21900001, -0.25800002, 9.882001], [583167809433933, 0.21900001, -0.27, 9.879001], [583167819213089, 0.216, -0.26295, 9.870001], [583167828992400, 0.22305001, -0.28005, 9.86505], [583167838771479, 0.21900001, -0.282, 9.879001], [583167848550669, 0.22305001, -0.25995, 9.88395], [583167858329976, 0.22305001, -0.25605002, 9.87405], [583167868109132, 0.22995001, -0.246, 9.88395], [583167877888452, 0.216, -0.25605002, 9.86205], [583167887667604, 0.216, -0.26295, 9.87405], [583167897446910, 0.22305001, -0.25800002, 9.89295], [583167907225974, 0.22095, -0.26505002, 9.88395], [583167917005125, 0.20895001, -0.27195, 9.87195], [583167926784423, 0.20205002, -0.27, 9.87405], [583167936563589, 0.20700002, -0.26505002, 9.87705], [583167946342900, 0.216, -0.26505002, 9.86505], [583167956122056, 0.20205002, -0.27495003, 9.87405], [583167965901147, 0.22305001, -0.26295, 9.8890505], [583167975680471, 0.21900001, -0.25605002, 9.89805], [583167985459627, 0.22305001, -0.28395, 9.87705], [583167995238933, 0.216, -0.26505002, 9.867001], [583168005018080, 0.216, -0.27, 9.88395], [583168014797380, 0.21900001, -0.27195, 9.88395], [583168024576536, 0.22605, -0.25995, 9.870001], [583168034355589, 0.22605, -0.26295, 9.87195], [583168044134895, 0.22095, -0.26295, 9.870001], [583168053914080, 0.21405001, -0.26295, 9.879001], [583168063693386, 0.23505001, -0.25995, 9.870001], [583168073472545, 0.23295002, -0.25995, 9.867001], [583168083251851, 0.216, -0.26295, 9.87405], [583168093030911, 0.22605, -0.27705002, 9.879001], [583168102810063, 0.22800002, -0.27, 9.87705], [583168112589376, 0.22305001, -0.27705002, 9.867001], [583168122368484, 0.22605, -0.27495003, 9.87705], [583168132147789, 0.21900001, -0.26805001, 9.879001], [583168141926954, 0.20205002, -0.26505002, 9.87705], [583168151706056, 0.21900001, -0.26805001, 9.87195], [583168161485362, 0.20700002, -0.26505002, 9.88605], [583168171264509, 0.216, -0.26505002, 9.879001], [583168181043814, 0.22605, -0.26295, 9.88605], [583168190822955, 0.22800002, -0.26805001, 9.87705], [583168200602242, 0.21105, -0.27195, 9.88395], [583168210381398, 0.216, -0.26295, 9.87405], [583168220160480, 0.22305001, -0.27, 9.87195], [583168229939786, 0.22305001, -0.27195, 9.882001], [583168239718931, 0.22305001, -0.26295, 9.879001], [583168249498242, 0.23295002, -0.25800002, 9.879001], [583168259277407, 0.22605, -0.26295, 9.882001], [583168269056713, 0.21105, -0.26805001, 9.867001], [583168278835884, 0.22305001, -0.26295, 9.87195], [583168288614961, 0.22095, -0.25995, 9.87195], [583168298394304, 0.22095, -0.25800002, 9.87405], [583168308173684, 0.22095, -0.26805001, 9.87705], [583168317952744, 0.21105, -0.25800002, 9.87195], [583168327731898, 0.22605, -0.25800002, 9.879001], [583168337511213, 0.22095, -0.26295, 9.87705], [583168347290369, 0.22995001, -0.25800002, 9.882001], [583168357069446, 0.22995001, -0.27, 9.879001], [583168366848780, 0.22095, -0.27495003, 9.87405], [583168376627946, 0.22095, -0.26805001, 9.87705], [583168386407252, 0.20700002, -0.27705002, 9.87195], [583168396186396, 0.20400001, -0.26805001, 9.879001], [583168405965722, 0.22305001, -0.27, 9.87195], [583168415744863, 0.21405001, -0.25995, 9.87405], [583168425523940, 0.23295002, -0.25605002, 9.87195], [583168435303342, 0.21900001, -0.27195, 9.86505], [583168445082415, 0.21405001, -0.26505002, 9.87195], [583168454861721, 0.20895001, -0.25095, 9.88395], [583168464640873, 0.20205002, -0.25995, 9.879001], [583168474420174, 0.22305001, -0.26295, 9.87405], [583168484199330, 0.21900001, -0.282, 9.882001], [583168493978620, 0.22305001, -0.26505002, 9.882001], [583168503757699, 0.22305001, -0.26805001, 9.882001], [583168513536818, 0.22800002, -0.26805001, 9.867001], [583168523316203, 0.22305001, -0.25995, 9.87405], [583168533095267, 0.24495001, -0.26505002, 9.867001], [583168542874572, 0.22995001, -0.26295, 9.88605], [583168552653742, 0.21900001, -0.26295, 9.88605], [583168562433048, 0.23295002, -0.26805001, 9.87405], [583168572212209, 0.22800002, -0.26295, 9.891001], [583168581991286, 0.21900001, -0.26505002, 9.88605], [583168591770592, 0.21105, -0.27195, 9.891001], [583168601549738, 0.22095, -0.27495003, 9.87195], [583168611329121, 0.21105, -0.26805001, 9.87195], [583168621108190, 0.22800002, -0.27195, 9.89295], [583168630887496, 0.22305001, -0.27495003, 9.867001], [583168640666623, 0.22305001, -0.25305, 9.870001], [583168650445928, 0.22995001, -0.25995, 9.87195], [583168660225132, 0.22095, -0.25305, 9.87195], [583168670004204, 0.22305001, -0.25095, 9.87195], [583168679783510, 0.22605, -0.25995, 9.87705], [583168689562671, 0.22305001, -0.27195, 9.879001], [583168699341981, 0.20895001, -0.27195, 9.87195], [583168709121151, 0.22605, -0.27705002, 9.870001], [583168718900457, 0.22305001, -0.28005, 9.87705], [583168728679604, 0.22305001, -0.27195, 9.87195], [583168738458910, 0.22605, -0.25095, 9.87195], [583168748238085, 0.22095, -0.25095, 9.879001], [583168758017390, 0.22605, -0.27195, 9.87405], [583168767796454, 0.22305001, -0.25800002, 9.882001], [583168777575837, 0.22800002, -0.27, 9.867001], [583168787354916, 0.21900001, -0.27, 9.87405], [583168797134070, 0.22095, -0.27, 9.87705], [583168806913375, 0.22605, -0.282, 9.882001], [583168816692507, 0.22605, -0.27705002, 9.870001], [583168826471813, 0.20895001, -0.25995, 9.87405], [583168836250983, 0.216, -0.27, 9.88395], [583168846030275, 0.21105, -0.25800002, 9.879001], [583168855809430, 0.216, -0.26295, 9.870001], [583168865588736, 0.21105, -0.25800002, 9.87195], [583168875367810, 0.216, -0.26505002, 9.88605], [583168885146962, 0.20895001, -0.26505002, 9.87195], [583168894926285, 0.22305001, -0.27195, 9.87405], [583168904705407, 0.22095, -0.27495003, 9.87405], [583168914484712, 0.22800002, -0.26805001, 9.891001], [583168924263858, 0.22605, -0.27195, 9.87195], [583168934043169, 0.22305001, -0.26805001, 9.86505], [583168943822325, 0.22305001, -0.25305, 9.88395], [583168953601601, 0.23505001, -0.25095, 9.87705], [583168963380757, 0.216, -0.25800002, 9.879001], [583168973159834, 0.21405001, -0.27705002, 9.882001], [583168982939135, 0.21900001, -0.282, 9.867001], [583168992718291, 0.20895001, -0.27495003, 9.87195], [583169002497611, 0.21105, -0.29205, 9.87405], [583169012276790, 0.22800002, -0.282, 9.87195], [583169022056096, 0.22605, -0.27495003, 9.879001], [583169031835233, 0.21405001, -0.24795002, 9.87705], [583169041614525, 0.216, -0.25305, 9.870001], [583169051393681, 0.22095, -0.25095, 9.879001], [583169061173010, 0.22095, -0.25605002, 9.87705], [583169070952166, 0.21900001, -0.27705002, 9.8890505], [583169080731224, 0.20205002, -0.282, 9.86505], [583169090510530, 0.21105, -0.27495003, 9.87195], [583169100289686, 0.20895001, -0.282, 9.87195], [583169110068971, 0.21105, -0.27705002, 9.867001], [583169119848143, 0.21900001, -0.26505002, 9.87705], [583169129627449, 0.22095, -0.26805001, 9.87195], [583169139406610, 0.21900001, -0.25995, 9.87705], [583169149185911, 0.21405001, -0.24795002, 9.87405], [583169158965066, 0.22800002, -0.25305, 9.87705], [583169168744381, 0.21405001, -0.25995, 9.87195], [583169178523537, 0.21900001, -0.27705002, 9.870001], [583169188302614, 0.22305001, -0.28005, 9.879001]],
        "gyro": [[583167237350515, 0.0001375, 0.0009625, -0.0], [583167247129848, -0.0011, 0.0009625, -0.0], [583167256909064, -0.0011, -0.000275, -0.0], [583167266688220, 0.0001375, 0.0009625, -0.0], [583167276467327, 0.0001375, 0.0009625, -0.0], [583167286246539, 0.0001375, -0.000275, -0.0], [583167296025738, 0.0001375, -0.000275, -0.0], [583167305804990, 0.0001375, -0.0015125, 0.0012375], [583167315584212, 0.0001375, -0.000275, 0.0012375], [583167325363331, -0.0011, 0.0009625, -0.0], [583167335142613, 0.001375, -0.000275, -0.0], [583167344921798, -0.0011, -0.000275, -0.0], [583167354701038, 0.001375, -0.000275, -0.0], [583167364480243, 0.0001375, -0.000275, -0.0012375], [583167374259500, -0.0011, -0.000275, -0.0], [583167384038708, 0.0001375, -0.000275, -0.0], [583167393817827, 0.0001375, -0.000275, -0.0], [583167403597045, 0.0001375, -0.000275, -0.0012375], [583167413376267, -0.0011, -0.000275, -0.0], [583167423155519, -0.0011, -0.000275, -0.0], [583167432934666, 0.0001375, 0.0009625, -0.0], [583167442713793, -0.0011, -0.000275, -0.0], [583167452493053, 0.0001375, 0.0009625, -0.0012375], [583167462272279, -0.0011, 0.0009625, -0.0012375], [583167472051531, 0.0001375, 0.0009625, -0.0012375], [583167481830711, 0.0001375, 0.0009625, -0.0], [583167491609811, 0.0001375, -0.000275, -0.0], [583167501389074, -0.0011, 0.0009625, -0.0012375], [583167511168230, 0.0001375, -0.000275, -0.0], [583167520947460, 0.0001375, -0.000275, -0.0], [583167530726679, 0.0001375, 0.0009625, -0.0], [583167540505792, -0.0011, -0.000275, -0.0012375], [583167550285045, -0.0011, -0.000275, -0.0], [583167560064365, 0.0001375, 0.0009625, 0.0012375], [583167569843545, 0.0001375, -0.000275, -0.0012375], [583167579622688, -0.0011, 0.0009625, -0.0], [583167589401889, -0.0011, -0.000275, -0.0], [583167599181096, 0.0001375, 0.0009625, -0.0], [583167608960197, 0.0001375, -0.000275, -0.0], [583167618739415, -0.0011, -0.0015125, 0.0012375], [583167628518636, 0.0001375, 0.0009625, -0.0], [583167638297860, -0.0011, -0.000275, -0.0], [583167648077062, 0.0001375, 0.0009625, -0.0012375], [583167657856181, 0.0001375, 0.0009625, -0.0], [583167667635459, -0.0011, -0.000275, -0.0], [583167677414644, -0.0011, -0.000275, -0.0], [583167687193864, 0.0001375, -0.000275, -0.0], [583167696973068, 0.0001375, -0.000275, 0.0012375], [583167706752201, 0.0001375, -0.000275, -0.0], [583167716531463, 0.0001375, -0.000275, -0.0], [583167726310788, -0.0011, -0.000275, -0.0], [583167736089963, -0.0023375, 0.0009625, 0.0012375], [583167745869101, -0.0011, -0.000275, -0.0], [583167755648341, -0.0011, -0.000275, 0.0012375], [583167765427548, -0.0011, -0.0015125, 0.0012375], [583167775206796, 0.0001375, -0.000275, -0.0], [583167784985960, -0.0011, -0.000275, -0.0], [583167794765091, 0.0001375, 0.0009625, -0.0], [583167804544293, -0.0023375, -0.000275, -0.0], [583167814323500, -0.0011, 0.0009625, -0.0], [583167824102758, -0.0011, -0.000275, -0.0], [583167833881922, -0.0011, 0.0009625, -0.0], [583167843661096, 0.0001375, 0.0009625, 0.0012375], [583167853440336, 0.0001375, -0.000275, -0.0], [583167863219543, 0.0001375, 0.0009625, -0.0], [583167872998810, -0.0011, -0.000275, -0.0], [583167882778015, -0.0011, -0.000275, -0.0], [583167892557268, -0.0011, 0.0009625, -0.0], [583167902336417, 0.0001375, -0.0015125, 0.0012375], [583167912115543, -0.0023375, -0.000275, -0.0], [583167921894783, 0.0001375, 0.0009625, -0.0], [583167931674000, -0.0011, 0.0009625, 0.0012375], [583167941453258, -0.0011, -0.000275, -0.0], [583167951232481, 0.0001375, 0.0009625, 0.0012375], [583167961011600, 0.0001375, 0.0009625, -0.0], [583167970790837, -0.0011, 0.0009625, 0.0012375], [583167980570039, 0.0001375, 0.0009625, -0.0], [583167990349282, -0.0011, 0.0009625, -0.0], [583168000128491, -0.0011, 0.0009625, -0.0], [583168009907738, -0.0011, 0.0009625, -0.0], [583168019686947, 0.0001375, -0.000275, -0.0], [583168029466042, 0.001375, -0.000275, -0.0], [583168039245260, -0.0011, -0.000275, -0.0012375], [583168049024492, -0.0011, -0.000275, -0.0], [583168058803744, -0.0011, 0.0009625, -0.0], [583168068582956, 0.001375, -0.0015125, -0.0], [583168078362209, 0.001375, -0.000275, -0.0], [583168088141354, 0.0001375, -0.000275, -0.0], [583168097920495, 0.0001375, -0.000275, -0.0], [583168107699736, 0.0001375, -0.000275, -0.0], [583168117478895, 0.0001375, -0.000275, -0.0], [583168127258156, -0.0011, -0.0015125, -0.0], [583168137037365, 0.0001375, -0.0015125, -0.0012375], [583168146816509, 0.0001375, -0.000275, -0.0], [583168156595727, 0.0001375, -0.000275, -0.0], [583168166374921, -0.0011, -0.000275, -0.0], [583168176154173, 0.0001375, 0.0009625, -0.0012375], [583168185933366, 0.0001375, -0.0015125, -0.0], [583168195712600, 0.001375, -0.000275, -0.0012375], [583168205491809, 0.0001375, -0.000275, -0.0], [583168215270933, -0.0011, -0.000275, -0.0], [583168225050141, -0.0011, -0.000275, -0.0], [583168234829344, -0.0011, -0.000275, -0.0012375], [583168244608600, -0.0011, 0.0009625, -0.0], [583168254387818, -0.0011, -0.000275, -0.0], [583168264167071, 0.0001375, -0.000275, -0.0], [583168273946295, -0.0011, 0.0009625, -0.0], [583168283725414, -0.0011, -0.000275, -0.0], [583168293504670, -0.0011, -0.000275, -0.0], [583168303284002, -0.0011, -0.000275, -0.0], [583168313063180, -0.0011, -0.000275, -0.0012375], [583168322842322, 0.0001375, -0.000275, -0.0], [583168332621573, 0.0001375, -0.000275, -0.0], [583168342400780, 0.0001375, -0.000275, -0.0012375], [583168352179899, -0.0011, -0.000275, -0.0], [583168361959145, -0.0011, 0.0009625, -0.0], [583168371738358, -0.0011, -0.000275, -0.0], [583168381517610, -0.0011, -0.000275, -0.0], [583168391296807, 0.001375, 0.0009625, -0.0], [583168401076080, 0.0001375, 0.0009625, -0.0], [583168410855274, -0.0011, -0.000275, 0.0012375], [583168420634393, 0.0001375, 0.0009625, -0.0], [583168430413675, -0.0011, -0.000275, -0.0], [583168440192854, 0.0001375, 0.0009625, -0.0], [583168449972084, 0.0001375, -0.000275, -0.0], [583168459751285, 0.0001375, 0.0009625, -0.0012375], [583168469530532, 0.0001375, -0.000275, 0.0012375], [583168479309741, -0.0023375, -0.000275, -0.0], [583168489088978, 0.0001375, 0.0009625, -0.0012375], [583168498868142, -0.0011, -0.000275, 0.0012375], [583168508647245, 0.0001375, 0.0009625, 0.0012375], [583168518426531, 0.0001375, 0.0009625, -0.0], [583168528205705, 0.0001375, 0.0009625, -0.0], [583168537984935, 0.0001375, 0.0009625, -0.0], [583168547764154, 0.0001375, -0.000275, -0.0012375], [583168557543406, 0.0001375, 0.0009625, -0.0], [583168567322620, -0.0011, -0.000275, -0.0], [583168577101739, 0.0001375, -0.000275, -0.0], [583168586880957, 0.0001375, -0.000275, -0.0], [583168596660151, 0.0001375, -0.000275, -0.0], [583168606439448, -0.0011, -0.0015125, -0.0], [583168616218628, 0.0001375, -0.000275, 0.0012375], [583168625997859, -0.0023375, 0.0009625, -0.0], [583168635777035, -0.0011, 0.0009625, -0.0], [583168645556335, 0.001375, 0.0009625, -0.0], [583168655335543, 0.001375, -0.000275, -0.0], [583168665114657, 0.0001375, 0.0009625, -0.0], [583168674893875, -0.0011, -0.000275, -0.0], [583168684673083, -0.0011, -0.000275, -0.0], [583168694452340, -0.0011, -0.000275, -0.0], [583168704231562, 0.0001375, 0.0009625, -0.0], [583168714010815, -0.0011, -0.000275, -0.0], [583168723790015, 0.0001375, -0.000275, 0.0012375], [583168733569268, 0.0001375, -0.000275, -0.0012375], [583168743348496, 0.0001375, -0.000275, -0.0], [583168753127748, 0.0001375, -0.000275, 0.0012375], [583168762906897, 0.0001375, 0.0009625, -0.0], [583168772686169, -0.0011, 0.0009625, -0.0], [583168782465354, 0.0001375, 0.0009625, 0.0012375], [583168792244494, 0.0001375, 0.0009625, 0.0012375], [583168802023735, 0.001375, -0.000275, 0.0], [583168811802918, 0.0001375, -0.000275, 0.0], [583168821582171, -0.0011, -0.000275, 0.0012375], [583168831361394, 0.001375, 0.0009625, 0.0012375], [583168841140633, -0.0023375, 0.0009625, 0.0], [583168850919841, -0.0011, -0.000275, 0.0], [583168860699094, 0.0001375, 0.0009625, 0.0], [583168870478253, -0.0011, 0.0009625, 0.0], [583168880257389, 0.0001375, 0.0009625, 0.0], [583168890036645, 0.001375, -0.000275, 0.0], [583168899815818, 0.0001375, -0.000275, 0.0], [583168909595060, -0.0011, 0.0009625, 0.0], [583168919374269, 0.0001375, -0.000275, 0.0], [583168929153527, -0.0011, -0.000275, 0.0012375], [583168938932736, -0.0011, -0.000275, 0.0012375], [583168948711959, -0.0011, -0.000275, 0.0], [583168958491168, 0.0001375, -0.000275, 0.0012375], [583168968270287, -0.0011, -0.0015125, 0.0], [583168978049500, -0.0011, -0.000275, 0.0], [583168987828717, -0.0011, -0.000275, 0.0], [583168997607969, 0.0001375, 0.0009625, 0.0], [583169007387201, -0.0011, -0.000275, 0.0], [583169017166454, -0.0011, -0.000275, 0.0], [583169026945644, -0.0011, 0.0009625, 0.0], [583169036724883, 0.0001375, 0.0009625, 0.0], [583169046504092, -0.0011, -0.000275, 0.0], [583169056283368, 0.0001375, -0.000275, 0.0012375], [583169066062577, 0.0001375, -0.000275, 0.0012375], [583169075841677, -0.0011, -0.000275, 0.0], [583169085620895, -0.0011, -0.000275, 0.0012375], [583169095400078, 0.0001375, -0.000275, 0.0], [583169105179330, -0.0011, -0.000275, 0.0], [583169114958554, 0.0001375, -0.000275, 0.0], [583169124737812, 0.0001375, 0.0009625, 0.0], [583169134517021, 0.0001375, -0.000275, 0.0], [583169144296269, -0.0011, -0.000275, 0.0], [583169154075477, -0.0011, 0.0009625, 0.0012375], [583169163854739, -0.0011, -0.000275, 0.0], [583169173633948, -0.0011, -0.000275, 0.0], [583169183413067, -0.0011, -0.0015125, 0.0]],
        "game_rv": [[583167237350511, -0.015088, -0.003893, -0.429792, 0.902793], [583167247129848, -0.015091, -0.003896, -0.429792, 0.902793], [583167256909064, -0.015088, -0.003896, -0.429791, 0.902793], [583167266688220, -0.01509, -0.003891, -0.429791, 0.902793], [583167276467327, -0.01509, -0.003889, -0.429791, 0.902793], [583167286246539, -0.015087, -0.003886, -0.429791, 0.902793], [583167296025738, -0.015081, -0.003907, -0.429834, 0.902773], [583167305804990, -0.015073, -0.003904, -0.429838, 0.902771], [583167315584212, -0.015134, -0.003959, -0.429838, 0.90277], [583167325363331, -0.015135, -0.003964, -0.429833, 0.902772], [583167335142613, -0.015191, -0.004014, -0.429831, 0.902772], [583167344921798, -0.015192, -0.004013, -0.429831, 0.902772], [583167354701038, -0.01529, -0.004038, -0.42983, 0.902771], [583167364480248, -0.015293, -0.004039, -0.429833, 0.902769], [583167374259500, -0.015405, -0.003998, -0.429829, 0.902769], [583167384038708, -0.015405, -0.004, -0.429831, 0.902768], [583167393817827, -0.015472, -0.004088, -0.429833, 0.902766], [583167403597045, -0.015473, -0.004087, -0.429833, 0.902766], [583167413376267, -0.015572, -0.004152, -0.429833, 0.902764], [583167423155503, -0.015571, -0.004152, -0.429836, 0.902763], [583167432934666, -0.015645, -0.004164, -0.429838, 0.90276], [583167442713793, -0.015646, -0.004163, -0.429841, 0.902759], [583167452493053, -0.015693, -0.004129, -0.42984, 0.902758], [583167462272279, -0.015696, -0.004128, -0.42984, 0.902758], [583167472051531, -0.015759, -0.004139, -0.429842, 0.902756], [583167481830711, -0.01576, -0.004138, -0.429848, 0.902754], [583167491609811, -0.015793, -0.00411, -0.429852, 0.902751], [583167501389074, -0.01579, -0.004107, -0.429852, 0.902751], [583167511168230, -0.01578, -0.0041, -0.429851, 0.902752], [583167520947475, -0.015784, -0.004101, -0.429853, 0.902751], [583167530726679, -0.015841, -0.00412, -0.429852, 0.90275], [583167540505792, -0.015843, -0.004121, -0.429852, 0.902751], [583167550285045, -0.015869, -0.004093, -0.42985, 0.902751], [583167560064370, -0.015876, -0.00409, -0.429852, 0.90275], [583167569843545, -0.015974, -0.004086, -0.429851, 0.902749], [583167579622688, -0.015974, -0.004082, -0.429848, 0.90275], [583167589401889, -0.016019, -0.004103, -0.429852, 0.902747], [583167599181096, -0.016018, -0.004098, -0.429851, 0.902748], [583167608960197, -0.016018, -0.004135, -0.429851, 0.902748], [583167618739433, -0.016015, -0.004138, -0.42985, 0.902748], [583167628518636, -0.016007, -0.004172, -0.42985, 0.902748], [583167638297860, -0.016012, -0.004175, -0.429847, 0.90275], [583167648077062, -0.016051, -0.004182, -0.429845, 0.90275], [583167657856181, -0.016055, -0.004182, -0.429844, 0.90275], [583167667635459, -0.016109, -0.00413, -0.429844, 0.902749], [583167677414644, -0.016113, -0.00412, -0.429846, 0.902748], [583167687193864, -0.016146, -0.004132, -0.429845, 0.902748], [583167696973083, -0.016152, -0.004131, -0.429844, 0.902749], [583167706752201, -0.016134, -0.004167, -0.429841, 0.90275], [583167716531463, -0.016134, -0.004172, -0.429838, 0.902752], [583167726310788, -0.016118, -0.004202, -0.429837, 0.902752], [583167736089963, -0.016115, -0.004208, -0.429836, 0.902753], [583167745869101, -0.016124, -0.004171, -0.429835, 0.902753], [583167755648341, -0.016132, -0.004166, -0.429832, 0.902754], [583167765427548, -0.016187, -0.004109, -0.429827, 0.902756], [583167775206796, -0.016191, -0.004108, -0.429822, 0.902758], [583167784985960, -0.016199, -0.004081, -0.429816, 0.902761], [583167794765091, -0.0162, -0.004083, -0.429816, 0.902761], [583167804544293, -0.016231, -0.004101, -0.429816, 0.902761], [583167814323500, -0.016228, -0.004102, -0.429819, 0.902759], [583167824102758, -0.01621, -0.004139, -0.42982, 0.902759], [583167833881922, -0.016212, -0.004137, -0.42982, 0.902759], [583167843661096, -0.01622, -0.004107, -0.42982, 0.902759], [583167853440336, -0.016219, -0.004106, -0.42982, 0.902759], [583167863219543, -0.016288, -0.0041, -0.429817, 0.902759], [583167872998810, -0.016287, -0.004099, -0.429818, 0.902759], [583167882778015, -0.016266, -0.004133, -0.429819, 0.902759], [583167892557268, -0.016261, -0.004138, -0.429819, 0.902758], [583167902336417, -0.016222, -0.004131, -0.42982, 0.902759], [583167912115543, -0.016223, -0.004129, -0.429823, 0.902757], [583167921894793, -0.0162, -0.004169, -0.429819, 0.902759], [583167931674000, -0.016206, -0.004172, -0.42982, 0.902759], [583167941453258, -0.016255, -0.004114, -0.429819, 0.902759], [583167951232481, -0.016254, -0.004113, -0.429815, 0.902761], [583167961011619, -0.016254, -0.004082, -0.429815, 0.902761], [583167970790837, -0.016249, -0.00408, -0.429813, 0.902762], [583167980570039, -0.016271, -0.003984, -0.429812, 0.902762], [583167990349282, -0.016273, -0.003981, -0.429811, 0.902763], [583168000128491, -0.016249, -0.004022, -0.42981, 0.902763], [583168009907738, -0.016247, -0.004022, -0.429811, 0.902763], [583168019686947, -0.016251, -0.003998, -0.429812, 0.902762], [583168029466042, -0.016252, -0.003993, -0.429816, 0.902761], [583168039245260, -0.016315, -0.003997, -0.429816, 0.902759], [583168049024492, -0.01631, -0.004002, -0.429814, 0.90276], [583168058803744, -0.016326, -0.004027, -0.42982, 0.902757], [583168068582956, -0.016328, -0.004031, -0.429822, 0.902756], [583168078362209, -0.016323, -0.004007, -0.429822, 0.902757], [583168088141354, -0.016322, -0.004013, -0.429822, 0.902756], [583168097920495, -0.016358, -0.004085, -0.429823, 0.902755], [583168107699736, -0.016354, -0.00409, -0.429826, 0.902754], [583168117478895, -0.016403, -0.004087, -0.429826, 0.902753], [583168127258156, -0.016407, -0.00409, -0.429821, 0.902755], [583168137037365, -0.016457, -0.004087, -0.429821, 0.902754], [583168146816509, -0.016465, -0.00409, -0.429824, 0.902753], [583168156595727, -0.016472, -0.004111, -0.429827, 0.902751], [583168166374921, -0.016469, -0.004116, -0.42983, 0.90275], [583168176154158, -0.016476, -0.004133, -0.42983, 0.902749], [583168185933366, -0.016479, -0.004131, -0.42983, 0.902749], [583168195712600, -0.016464, -0.004097, -0.429835, 0.902747], [583168205491809, -0.016463, -0.004101, -0.429836, 0.902747], [583168215270933, -0.016469, -0.004123, -0.429841, 0.902744], [583168225050141, -0.016468, -0.004125, -0.429841, 0.902744], [583168234829349, -0.016454, -0.004093, -0.429838, 0.902746], [583168244608600, -0.016455, -0.004091, -0.429838, 0.902746], [583168254387818, -0.016512, -0.004087, -0.429839, 0.902744], [583168264167071, -0.016515, -0.004081, -0.429839, 0.902744], [583168273946295, -0.016498, -0.004162, -0.42984, 0.902744], [583168283725452, -0.016498, -0.004164, -0.42984, 0.902744], [583168293504665, -0.016482, -0.004128, -0.429839, 0.902745], [583168303284002, -0.016482, -0.004128, -0.429841, 0.902744], [583168313063180, -0.016495, -0.004139, -0.42984, 0.902744], [583168322842322, -0.016497, -0.00414, -0.42984, 0.902744], [583168332621573, -0.016501, -0.004155, -0.429844, 0.902742], [583168342400780, -0.016503, -0.004155, -0.429844, 0.902742], [583168352179899, -0.016465, -0.004189, -0.429844, 0.902743], [583168361959145, -0.016465, -0.004187, -0.429845, 0.902742], [583168371738358, -0.016432, -0.004217, -0.429843, 0.902744], [583168381517599, -0.016434, -0.004214, -0.429842, 0.902744], [583168391296827, -0.016495, -0.004199, -0.429838, 0.902745], [583168401076080, -0.016495, -0.004196, -0.429837, 0.902745], [583168410855274, -0.016523, -0.004139, -0.429835, 0.902746], [583168420634412, -0.016521, -0.004139, -0.429835, 0.902746], [583168430413675, -0.016529, -0.004152, -0.429832, 0.902747], [583168440192854, -0.016531, -0.004149, -0.429829, 0.902749], [583168449972084, -0.016518, -0.004223, -0.429829, 0.902749], [583168459751285, -0.016515, -0.00423, -0.429829, 0.902749], [583168469530532, -0.016497, -0.004195, -0.429831, 0.902748], [583168479309741, -0.016494, -0.004195, -0.429833, 0.902748], [583168489088978, -0.016455, -0.004119, -0.429829, 0.90275], [583168498868142, -0.016461, -0.004117, -0.429828, 0.90275], [583168508647245, -0.016505, -0.004112, -0.42983, 0.902749], [583168518426516, -0.016515, -0.004107, -0.429827, 0.90275], [583168528205705, -0.016515, -0.004123, -0.429822, 0.902752], [583168537984935, -0.016513, -0.004119, -0.42982, 0.902754], [583168547764154, -0.016512, -0.004132, -0.429817, 0.902755], [583168557543406, -0.016507, -0.00413, -0.429818, 0.902755], [583168567322620, -0.016509, -0.004146, -0.429818, 0.902755], [583168577101739, -0.016503, -0.004147, -0.429821, 0.902753], [583168586880957, -0.016526, -0.004198, -0.429822, 0.902752], [583168596660151, -0.016529, -0.004205, -0.429822, 0.902752], [583168606439438, -0.01653, -0.004216, -0.429822, 0.902752], [583168616218628, -0.01653, -0.004216, -0.429822, 0.902752], [583168625997859, -0.016581, -0.004207, -0.429824, 0.90275], [583168635777035, -0.016583, -0.004208, -0.429822, 0.902751], [583168645556335, -0.016628, -0.004189, -0.429822, 0.90275], [583168655335543, -0.01663, -0.004184, -0.429822, 0.90275], [583168665114657, -0.016577, -0.004218, -0.429824, 0.90275], [583168674893880, -0.016574, -0.004221, -0.429824, 0.90275], [583168684673083, -0.016527, -0.004249, -0.429825, 0.90275], [583168694452340, -0.016526, -0.004248, -0.429826, 0.90275], [583168704231562, -0.016533, -0.004254, -0.429826, 0.90275], [583168714010815, -0.016534, -0.004256, -0.429826, 0.902749], [583168723790015, -0.016558, -0.0042, -0.429826, 0.90275], [583168733569268, -0.01656, -0.004194, -0.429823, 0.902751], [583168743348496, -0.016607, -0.004184, -0.429821, 0.902751], [583168753127748, -0.01661, -0.004188, -0.429823, 0.90275], [583168762906897, -0.016561, -0.00422, -0.429827, 0.902749], [583168772686169, -0.016556, -0.004222, -0.429825, 0.90275], [583168782465354, -0.016602, -0.004207, -0.429824, 0.902749], [583168792244494, -0.016605, -0.004205, -0.429825, 0.902749], [583168802023735, -0.016603, -0.004217, -0.429823, 0.90275], [583168811802918, -0.016604, -0.004216, -0.429821, 0.902751], [583168821582185, -0.016598, -0.004228, -0.429819, 0.902752], [583168831361394, -0.016599, -0.004229, -0.429819, 0.902752], [583168841140633, -0.016641, -0.004218, -0.429817, 0.902752], [583168850919841, -0.016644, -0.004217, -0.429814, 0.902753], [583168860699094, -0.016619, -0.004175, -0.429812, 0.902755], [583168870478253, -0.016623, -0.004175, -0.429812, 0.902755], [583168880257404, -0.016598, -0.004144, -0.429812, 0.902755], [583168890036645, -0.016598, -0.004142, -0.429813, 0.902755], [583168899815818, -0.016577, -0.004112, -0.429811, 0.902757], [583168909595060, -0.016571, -0.004113, -0.429811, 0.902757], [583168919374269, -0.016614, -0.004109, -0.429814, 0.902754], [583168929153527, -0.016617, -0.004107, -0.429815, 0.902754], [583168938932736, -0.016614, -0.004123, -0.429816, 0.902754], [583168948711959, -0.016614, -0.004122, -0.429814, 0.902755], [583168958491168, -0.016616, -0.004136, -0.42981, 0.902756], [583168968270287, -0.016615, -0.004139, -0.429807, 0.902757], [583168978049500, -0.016588, -0.004223, -0.429807, 0.902758], [583168987828717, -0.016593, -0.004226, -0.429805, 0.902758], [583168997607969, -0.016617, -0.004165, -0.429806, 0.902758], [583169007387201, -0.016621, -0.004164, -0.429807, 0.902758], [583169017166454, -0.016637, -0.004112, -0.429804, 0.902759], [583169026945644, -0.016642, -0.004106, -0.429805, 0.902758], [583169036724883, -0.01668, -0.004102, -0.429806, 0.902757], [583169046504092, -0.016687, -0.004099, -0.429807, 0.902756], [583169056283368, -0.016619, -0.004091, -0.429809, 0.902757], [583169066062558, -0.016614, -0.004087, -0.42981, 0.902757], [583169075841677, -0.016564, -0.004128, -0.42981, 0.902757], [583169085620895, -0.016562, -0.004131, -0.429806, 0.902759], [583169095400078, -0.016608, -0.004123, -0.429809, 0.902757], [583169105179330, -0.01661, -0.00412, -0.429808, 0.902758], [583169114958554, -0.016632, -0.004074, -0.429808, 0.902757], [583169124737812, -0.016632, -0.004074, -0.429806, 0.902758], [583169134517021, -0.016653, -0.004028, -0.429807, 0.902758], [583169144296269, -0.016647, -0.004031, -0.429807, 0.902757], [583169154075486, -0.016641, -0.004052, -0.429809, 0.902757], [583169163854739, -0.016641, -0.004053, -0.429808, 0.902757], [583169173633948, -0.016572, -0.004047, -0.429807, 0.902759], [583169183413067, -0.016574, -0.004046, -0.429808, 0.902758]]
    })
    # com_data()
    # asyncio.run(run_services())
